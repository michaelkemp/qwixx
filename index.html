<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <title>QWIXX</title>
    <style>
      body{
        font-size: 30px;
      }
      table {
        margin: 10px auto; 
        border-collapse: collapse;
      }
      .checks > td {
        width:40px;
        text-align:center;
        border: 3px solid;
        cursor: pointer;
        padding: 5px;
      }
      .strikes > td {
        width:50px;
        text-align:center;
        border: 3px solid;
        border-color: #000;
        cursor: pointer;
        padding: 5px;
        color: #000;
      }
      .scores > td {
        width:70px;
        height:70px;
        text-align:center;
        border: 3px solid;
        border-color: #000;
        padding: 5px;
        color: #000;
      }
      #redrow, #red {
        background-color: rgba(255, 0, 0, 0.5);
      }
      #redrow > td {
        border-color: #ff0000;
      }
      #yellowrow, #yellow {
        background-color: rgba(255, 255, 0, 0.5);
      }
      #yellowrow > td {
        border-color: #ffff00;
      }
      #greenrow, #green {
        background-color: rgba(0, 128, 0, 0.5);
      }
      #greenrow > td {
        border-color: #008000;
      }
      #bluerow, #blue {
        background-color: rgba(0, 0, 255, 0.5);
      }
      #bluerow > td {
        border-color: #0000ff;
      }
      #strikerow, #strike {
        background-color: rgba(128, 128, 128, 0.5);
      }
      #total {
        font-size: 55px;
      }
    </style>
  </head>
  <body>
    <div>
      <table>
        <tr id="redrow" class="checks">
          <td id="red0">2</td>
          <td id="red1">3</td>
          <td id="red2">4</td>
          <td id="red3">5</td>
          <td id="red4">6</td>
          <td id="red5">7</td>
          <td id="red6">8</td>
          <td id="red7">9</td>
          <td id="red8">10</td>
          <td id="red9">11</td>
          <td id="red10">12</td>
          <td id="red11"><i class="fa-solid fa-lock"></i></td>
        </tr>
        <tr id="yellowrow" class="checks">
          <td id="yellow0">2</td>
          <td id="yellow1">3</td>
          <td id="yellow2">4</td>
          <td id="yellow3">5</td>
          <td id="yellow4">6</td>
          <td id="yellow5">7</td>
          <td id="yellow6">8</td>
          <td id="yellow7">9</td>
          <td id="yellow8">10</td>
          <td id="yellow9">11</td>
          <td id="yellow10">12</td>
          <td id="yellow11"><i class="fa-solid fa-lock"></i></td>
        </tr>
        <tr id="greenrow" class="checks">
          <td id="green0">12</td>
          <td id="green1">11</td>
          <td id="green2">10</td>
          <td id="green3">9</td>
          <td id="green4">8</td>
          <td id="green5">7</td>
          <td id="green6">6</td>
          <td id="green7">5</td>
          <td id="green8">4</td>
          <td id="green9">3</td>
          <td id="green10">2</td>
          <td id="green11"><i class="fa-solid fa-lock"></i></td>
        </tr>
        <tr id="bluerow" class="checks">
          <td id="blue0">12</td>
          <td id="blue1">11</td>
          <td id="blue2">10</td>
          <td id="blue3">9</td>
          <td id="blue4">8</td>
          <td id="blue5">7</td>
          <td id="blue6">6</td>
          <td id="blue7">5</td>
          <td id="blue8">4</td>
          <td id="blue9">3</td>
          <td id="blue10">2</td>
          <td id="blue11"><i class="fa-solid fa-lock"></i></td>
        </tr>
      </table>

      <table>
        <tr id="strikerow" class="strikes">
          <td id="strike0"><i class="fa-solid fa-dice"></i></td>
          <td id="strike1"><i class="fa-solid fa-dice"></i></td>
          <td id="strike2"><i class="fa-solid fa-dice"></i></td>
          <td id="strike3"><i class="fa-solid fa-dice"></i></td>
        </tr>
      </table>

      <table>
        <tr class="scores">
          <td class="score" id="red">0</td>
          <td class="score" id="yellow">0</td>
          <td class="score" id="green">0</td>
          <td class="score" id="blue">0</td>
          <td class="score" id="strike">0</td>
          <td class="score" id="total">0</td>
        </tr>
      </table>
    </div>

	<script>
    (function () {
      const lo = ["2","3","4","5","6","7","8","9","10","11","12",'<i class="fa-solid fa-lock"></i>'];
      const hi = ["12","11","10","9","8","7","6","5","4","3","2",'<i class="fa-solid fa-lock"></i>'];
      const scr = [0,1,3,6,10,15,21,28,36,45,55,66,78];
      let red    = [0,0,0,0,0,0,0,0,0,0,0,0];
      let yellow = [0,0,0,0,0,0,0,0,0,0,0,0];
      let green  = [0,0,0,0,0,0,0,0,0,0,0,0];
      let blue   = [0,0,0,0,0,0,0,0,0,0,0,0];
      let strike = [0,0,0,0];


      for(let i=0; i<4; ++i) {
        let strikeEl = document.getElementById("strike"+i);
        strikeEl.addEventListener('click', function(){ 
            if (this.innerHTML == '<i class="fa-solid fa-dice"></i>') {
              this.innerHTML = '<i class="fa-solid fa-x"></i>';
              strike[i] = 1;
            } else {
              this.innerHTML = '<i class="fa-solid fa-dice"></i>';
              strike[i] = 0;
            }
            score();
        });
      }

      function score() {
        let r = 0;
        let y = 0;
        let g = 0;
        let b = 0;
        let s = 0;
        for(let i=0; i<4; ++i) {
          s+= strike[i];
        }
        for(let i=0;i<10;++i) {
          r += red[i];
          y += yellow[i];
          g += green[i];
          b += blue[i];
        }
        if ((red[10] == 1) && (red[11] == 1)) { r += 2; }
        if ((yellow[10] == 1) && (yellow[11] == 1)) { y += 2; }
        if ((green[10] == 1) && (green[11] == 1)) { g += 2; }
        if ((blue[10] == 1) && (blue[11] == 1)) { b += 2; }
        let tr = scr[r];
        let ty = scr[y];
        let tg = scr[g];
        let tb = scr[b];
        let ts = s * -5;
        let total = tr + ty + tg + tb + ts;
        let sred = document.getElementById("red");
        let syellow = document.getElementById("yellow");
        let sgreen = document.getElementById("green");
        let sblue = document.getElementById("blue");
        let sstrike = document.getElementById("strike");
        let stotal = document.getElementById("total");
        sred.innerHTML=tr;
        syellow.innerHTML=ty;
        sgreen.innerHTML=tg;
        sblue.innerHTML=tb;
        sstrike.innerHTML=ts;
        stotal.innerHTML=total;
      }

      function can(arr, num) {
        // if locked return false
        if ((num != 11) && (arr[11] == 1)) {
          return 0;
        }
        // only if they have 5 others checked
        if (num == 10) {
          let cnt = 0;
          for(let i=0; i<10; ++i) {
            cnt += arr[i];
          }
          if (cnt < 5) {
            return 0;
          }
          return 1;
        }
        // cant check earlier number
        let later = 0;
        for(let i=11; i>num; --i) {
          later += arr[i];
        }
        if (later == 0) {
          return 1;
        }
        return 0;
      }

      for(let i=0; i<12; ++i) {
        let redEl = document.getElementById("red"+i);
        let yellowEl = document.getElementById("yellow"+i);
        let greenEl = document.getElementById("green"+i);
        let blueEl = document.getElementById("blue"+i);
        redEl.addEventListener('click', function(){ 
            if (this.innerHTML == lo[i]) {
              if (can(red,i)) {
                this.innerHTML = '<i class="fa-solid fa-x"></i>';
                red[i] = 1;
              }
            } else {
              if ((i == 11) || (red[11] == 0)) { // not locked
                this.innerHTML = lo[i];
                red[i] = 0;
              }
            }
            score();
        });
        yellowEl.addEventListener('click', function(){ 
            if (this.innerHTML == lo[i]) {
              if (can(yellow,i)) {
                this.innerHTML = '<i class="fa-solid fa-x"></i>';
                yellow[i] = 1;
              }
            } else {
              if ((i == 11) || (yellow[11] == 0)) { // not locked
                this.innerHTML = lo[i];
                yellow[i] = 0;
              }
            }
            score();
        });
        greenEl.addEventListener('click', function(){ 
            if (this.innerHTML == hi[i]) {
              if (can(green,i)) {
                this.innerHTML = '<i class="fa-solid fa-x"></i>';
                green[i] = 1;
              }
            } else {
              if ((i == 11) || (green[11] == 0)) { // not locked
                this.innerHTML = hi[i];
                green[i] = 0;
              }
            }
            score();
        });
        blueEl.addEventListener('click', function(){ 
            if (this.innerHTML == hi[i]) {
              if (can(blue,i)) {
                this.innerHTML = '<i class="fa-solid fa-x"></i>';
                blue[i] = 1;
              }
            } else {
              if ((i == 11) || (blue[11] == 0)) { // not locked
                this.innerHTML = hi[i];
                blue[i] = 0;
              }
            }
            score();
        });
      }

    })();
  </script>
  </body>
</html>

